/*
 * Copyright (c) 2020 De Staat der Nederlanden, Ministerie van Volksgezondheid, Welzijn en Sport.
 *  Licensed under the EUROPEAN UNION PUBLIC LICENCE v. 1.2
 *
 *  SPDX-License-Identifier: EUPL-1.2
 */

@testable import ENCore
import XCTest

final class SignatureValidatorTests: XCTestCase {
    private let signatureValidator = SignatureValidator()

    func test_signatureValidator() {
        XCTAssertTrue(signatureValidator.validate(signature: signatureExample, content: contentExample))
    }

    // MARK: - Private

    private var contentExample: Data {
        return """
        {"exposureKeySets":[],"riskCalculationParameters":"ac40786d07cf906028ef3bd068ba04d8014ccb0160ca08e5fd6a53058122d958","appConfig":"30ab638acc04dff8d002907d9eaeb320a3a2ca87b477a7a2666bdb7dde65b8a5"}
        """
        .data(using: .utf8)!
    }

    private var signatureExample: Data {
        return Data(base64Encoded: """
        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
        """)!
    }
}
